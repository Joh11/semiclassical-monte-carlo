#+title: Semiclassical Monte Carlo

* TODO How it works
1. [X] Generate a random state vector
2. [X] Monte Carlo steps for convergence
3. [X] Compute known values, like energy or magnetization
4. [X] Determine the step for decorrelation
5. [X] Write RK8 (Dormand-Prince)
6. [X] Compute (dynamical) structural factor
7. [X] Put everything together

* Data format
- state vector : =(3, Ns, Nx, Ny)=

* Steps for MC simulations
1. Figure out the thermalization step using energy and magnetization
2. Figure out the stride looking at correlation
3. Run it ?

See the file [[file:checkparams.jl]] for these two steps. 

* Reproducing figure 4 from the SCMC paper
** Target figures

** TODO Fix the wrong \(S\vec q(t)\) problem
*** TODO Simple try with a single sample

#+DOWNLOADED: screenshot @ 2021-03-02 19:51:18
#+CAPTION: Figure 4 from the paper
[[file:imgs/2021-03-02_19-51-18_screenshot.png]]

    
#+DOWNLOADED: screenshot @ 2021-03-02 17:16:17
#+CAPTION: Only the first sample
[[file:imgs/2021-03-02_17-16-17_screenshot.png]]

#+DOWNLOADED: screenshot @ 2021-03-02 17:17:23
#+CAPTION: 74 samples
[[file:imgs/2021-03-02_17-17-23_screenshot.png]]


#+DOWNLOADED: screenshot @ 2021-03-02 19:44:50
#+CAPTION: 403 samples
[[file:imgs/2021-03-02_19-44-50_screenshot.png]]

*** Possible explanations
- Code is wrong (still possible)
- Some scaling issue:
  - For the temperature => wrong phase
  - For the momentum space => perhaps with other kpoints it's fine
- Convergence issue ? Unlikely


* Basic checks of the Dormand Prince scheme
** TODO Two sites analytical comparaison
